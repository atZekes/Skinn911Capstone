# Booking Notification Flow Diagram

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        BOOKING NOTIFICATION SYSTEM                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

                              NOTIFICATION TRIGGERS
                              â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚   Staff      â”‚      â”‚   Cron Job   â”‚      â”‚   Client     â”‚
    â”‚   Actions    â”‚      â”‚   (Daily)    â”‚      â”‚   Actions    â”‚
    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚                     â”‚                     â”‚
           â”‚                     â”‚                     â”‚
           â–¼                     â–¼                     â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ â€¢ Cancel    â”‚      â”‚ â€¢ Send      â”‚      â”‚ â€¢ Book      â”‚
    â”‚ â€¢ Complete  â”‚      â”‚   Reminder  â”‚      â”‚   Service   â”‚
    â”‚ â€¢ Manual    â”‚      â”‚   (1 day    â”‚      â”‚             â”‚
    â”‚   Reminder  â”‚      â”‚   before)   â”‚      â”‚             â”‚
    â”‚ â€¢ Refund    â”‚      â”‚             â”‚      â”‚             â”‚
    â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚                    â”‚                     â”‚
          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                               â”‚
                               â”‚
                               â–¼
          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
          â”‚     sendPushNotification() Method          â”‚
          â”‚  app/Http/Controllers/*Controller.php      â”‚
          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â”‚
                â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                â”‚                     â”‚
                â–¼                     â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  DATABASE STORAGE    â”‚  â”‚   REAL-TIME PUSHER   â”‚
    â”‚  (Persistent)        â”‚  â”‚   (Instant Delivery) â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚                         â”‚
               â–¼                         â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  notifications table â”‚  â”‚   Pusher Channel:    â”‚
    â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â”‚   'user-{userId}'    â”‚
    â”‚  â”‚ user_id        â”‚  â”‚  â”‚   Event:             â”‚
    â”‚  â”‚ title          â”‚  â”‚  â”‚   'notification'     â”‚
    â”‚  â”‚ message        â”‚  â”‚  â”‚                      â”‚
    â”‚  â”‚ type           â”‚  â”‚  â”‚   Payload:           â”‚
    â”‚  â”‚ booking_id     â”‚  â”‚  â”‚   - title            â”‚
    â”‚  â”‚ read: false    â”‚  â”‚  â”‚   - message          â”‚
    â”‚  â”‚ created_at     â”‚  â”‚  â”‚   - type             â”‚
    â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â”‚   - booking_id       â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚                         â”‚
               â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
                             â–¼
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚     CLIENT BROWSER           â”‚
              â”‚  (clientapp.blade.php)       â”‚
              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
                â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                â”‚                         â”‚
                â–¼                         â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚   ON PAGE LOAD       â”‚  â”‚   REAL-TIME          â”‚
    â”‚                      â”‚  â”‚   (Pusher Listener)  â”‚
    â”‚   GET /api/          â”‚  â”‚                      â”‚
    â”‚   notifications      â”‚  â”‚   Echo.private()     â”‚
    â”‚                      â”‚  â”‚   .listen()          â”‚
    â”‚   â€¢ Load all         â”‚  â”‚                      â”‚
    â”‚     existing         â”‚  â”‚   â€¢ Show toast       â”‚
    â”‚     notifications    â”‚  â”‚   â€¢ Update badge     â”‚
    â”‚   â€¢ Display count    â”‚  â”‚   â€¢ Play sound       â”‚
    â”‚   â€¢ Show in dropdown â”‚  â”‚   â€¢ Add to list      â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
                             â–¼
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚   NOTIFICATION DISPLAY       â”‚
              â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
              â”‚   â”‚ ğŸ”” (4)                 â”‚ â”‚
              â”‚   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚
              â”‚   â”‚ Booking Cancelled      â”‚ â”‚
              â”‚   â”‚ Your booking has...    â”‚ â”‚
              â”‚   â”‚ âš ï¸ warning             â”‚ â”‚
              â”‚   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚
              â”‚   â”‚ Booking Completed      â”‚ â”‚
              â”‚   â”‚ Your booking has...    â”‚ â”‚
              â”‚   â”‚ âœ… success             â”‚ â”‚
              â”‚   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚
              â”‚   â”‚ Appointment Reminder   â”‚ â”‚
              â”‚   â”‚ You have an upcoming...â”‚ â”‚
              â”‚   â”‚ â„¹ï¸ info                â”‚ â”‚
              â”‚   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚
              â”‚   â”‚ Refund Processed       â”‚ â”‚
              â”‚   â”‚ Your refund has...     â”‚ â”‚
              â”‚   â”‚ â„¹ï¸ info                â”‚ â”‚
              â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
                             â–¼
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚   USER INTERACTIONS          â”‚
              â”‚                              â”‚
              â”‚   â€¢ Click notification       â”‚
              â”‚     â†’ Redirect to dashboard  â”‚
              â”‚     â†’ PATCH /api/            â”‚
              â”‚       notifications/{id}/readâ”‚
              â”‚                              â”‚
              â”‚   â€¢ Mark all as read         â”‚
              â”‚     â†’ POST /api/             â”‚
              â”‚       notifications/         â”‚
              â”‚       mark-all-read          â”‚
              â”‚                              â”‚
              â”‚   â€¢ Refresh page             â”‚
              â”‚     â†’ Notifications persist! â”‚
              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


                        NOTIFICATION TYPE MAPPING
                        â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

    â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•¦â•â•â•â•â•â•â•â•â•â•â•â•¦â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
    â•‘ Booking Event     â•‘ Type      â•‘ Title                           â•‘
    â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•¬â•â•â•â•â•â•â•â•â•â•â•â•¬â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
    â•‘ Cancelled         â•‘ warning   â•‘ Booking Cancelled               â•‘
    â•‘ Completed         â•‘ success   â•‘ Booking Completed               â•‘
    â•‘ Reminder (Manual) â•‘ info      â•‘ Appointment Reminder            â•‘
    â•‘ Reminder (Auto)   â•‘ info      â•‘ Appointment Reminder            â•‘
    â•‘ Refund            â•‘ info      â•‘ Refund Processed                â•‘
    â•‘ Booking Created   â•‘ success   â•‘ Booking Confirmed               â•‘
    â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•©â•â•â•â•â•â•â•â•â•â•â•â•©â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•


                        DATABASE SCHEMA
                        â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

    notifications table
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ Field       â”‚ Type           â”‚ Null     â”‚ Key     â”‚ Default     â”‚
    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
    â”‚ id          â”‚ bigint(20)     â”‚ NO       â”‚ PRI     â”‚ AUTO_INC    â”‚
    â”‚ user_id     â”‚ bigint(20)     â”‚ NO       â”‚ FK      â”‚             â”‚
    â”‚ title       â”‚ varchar(255)   â”‚ NO       â”‚         â”‚             â”‚
    â”‚ message     â”‚ text           â”‚ NO       â”‚         â”‚             â”‚
    â”‚ type        â”‚ enum           â”‚ NO       â”‚         â”‚ info        â”‚
    â”‚ read        â”‚ tinyint(1)     â”‚ NO       â”‚         â”‚ 0           â”‚
    â”‚ booking_id  â”‚ bigint(20)     â”‚ YES      â”‚ FK      â”‚ NULL        â”‚
    â”‚ data        â”‚ json           â”‚ YES      â”‚         â”‚ NULL        â”‚
    â”‚ created_at  â”‚ timestamp      â”‚ YES      â”‚         â”‚ NULL        â”‚
    â”‚ updated_at  â”‚ timestamp      â”‚ YES      â”‚         â”‚ NULL        â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

    type enum values: 'success', 'error', 'warning', 'info'


                        API ENDPOINTS
                        â”â”â”â”â”â”â”â”â”â”â”â”â”

    GET    /api/notifications                  â†’ Get all notifications
    POST   /api/notifications                  â†’ Create notification
    PATCH  /api/notifications/{id}/read        â†’ Mark as read
    POST   /api/notifications/mark-all-read    â†’ Mark all as read


                    KEY FEATURES
                    â”â”â”â”â”â”â”â”â”â”â”â”

    âœ… Persist across page refreshes
    âœ… Real-time delivery via Pusher
    âœ… Database storage for reliability
    âœ… Linked to bookings via booking_id
    âœ… Clickable to view booking details
    âœ… Mark as read/unread
    âœ… Badge count display
    âœ… Toast notifications
    âœ… API for programmatic access
    âœ… Automated cron job reminders
```
