@startuml DFD_Level_0_SkinSync
title DFD Level 0 — SkinSync Booking System
' System boundary
note left
  Level 0 - single high-level process (SkinSync System)
  External entities: rectangles
  Data stores: cylinder (database)
  Data flows: labeled arrows
end note
rectangle "SkinSync System" as SkinSync

' External entities
rectangle "Client" as Client
rectangle "Staff" as Staff
rectangle "Admin" as Admin
rectangle "CEO" as CEO
rectangle "Email Service" as Email

' System boundary

database "Database (MySQL)" as DB
rectangle "File Storage" as FILES

' Data flows (high-level, consistent labels)
Client --> SkinSync : Booking Request / Profile Update / Inquiries
SkinSync --> Client : Booking Confirmation / Reminders / Account Updates

Staff --> SkinSync : Staff Availability / Check-in / Manage Walk-ins
SkinSync --> Staff : Assigned Bookings / Schedules / Reports 

Admin --> SkinSync : Service & Staff Management / Pricing Updates
SkinSync --> Admin : System Config / Activity Logs / Reports

CEO --> SkinSync : Request Performance Reports
SkinSync --> CEO : Branch Performance / Revenue Summaries / Analytics

SkinSync --> Email : Send Booking & Reminder Emails
Email --> Client : Email Notifications

' Data stores
SkinSync --> DB : Read / Write (Users, Bookings, Services, Branches)
DB --> SkinSync : Return Data

SkinSync --> FILES : Upload / Retrieve images (receipts, client uploads)
FILES --> SkinSync : Stored files

note right
  Payment: not implemented yet — transactions saved locally as 'payment_pending'
end note

@enduml


@startuml DFD_Level_1_Booking
title DFD Level 1 — Booking Process (SkinSync)

' Legend
note left
  Level 1 — decomposes the Booking sub-process from Level 0
  Steps: Request -> Validate -> Reserve -> Store -> Confirm
end note

' External entities
rectangle "Client" as Client
rectangle "Staff" as Staff

' Processes (Booking flow)
rectangle "1. Receive Booking Request" as P1
rectangle "2. Validate Availability" as P2
rectangle "3. Reserve Time Slot" as P3
rectangle "4. Store Booking" as P4
rectangle "5. Send Confirmation" as P5

' Data stores
database "Database (Bookings & Users)" as DB
rectangle "File Storage" as FILES

' Data flows
Client --> P1 : Booking Request (service, branch, datetime, client info)
P1 --> P2 : Request with client & service details
P2 --> DB : Query availability (branch, staff, slot)
DB --> P2 : Availability result
P2 --> P3 : Approved / Candidate slot
P3 --> DB : Reserve slot (tentative)
P3 --> P4 : Reservation details
P4 --> DB : Save booking record (status=booked or pending)
P4 --> FILES : (optional) Save attachments / receipts
P4 --> P5 : Trigger confirmation
P5 --> Client : Booking confirmation (email and in-app)

' Staff may be notified or accept walk-in/reschedules
Staff --> P2 : Update availability (if manual override)
P2 --> Staff : Inform of conflicts / alternative slots

note right
  Error handling (simplified): If P2 finds no availability -> return alternative slots -> Client may resubmit.
end note

@enduml
