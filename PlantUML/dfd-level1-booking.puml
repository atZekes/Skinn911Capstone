@startuml DFD_Level_1_Booking
title DFD Level 1 â€” Booking Process (SkinSync)

' Legend
note left
  Level 1 â€” decomposes the Booking sub-process from Level 0
  Steps: Request -> Validate -> Reserve -> Store -> Confirm
end note

' External entities
rectangle "Client" as Client
rectangle "Staff" as Staff

' Processes (Booking flow)
rectangle "1. Receive Booking Request" as P1
rectangle "2. Validate Availability" as P2
rectangle "3. Reserve Time Slot" as P3
rectangle "4. Store Booking" as P4
rectangle "5. Send Confirmation" as P5

' Data stores
database "Database (Bookings & Users)" as DB
rectangle "File Storage" as FILES

' Data flows
Client --> P1 : Booking Request (service, branch, datetime, client info)
P1 --> P2 : Request with client & service details
P2 --> DB : Query availability (branch, staff, slot)
DB --> P2 : Availability result
P2 --> P3 : Approved / Candidate slot
P3 --> DB : Reserve slot (tentative)
P3 --> P4 : Reservation details
P4 --> DB : Save booking record (status=booked or pending)
P4 --> FILES : (optional) Save attachments / receipts
P4 --> P5 : Trigger confirmation
P5 --> Client : Booking confirmation (email and in-app)

' Staff may be notified or accept walk-in/reschedules
Staff --> P2 : Update availability (if manual override)
P2 --> Staff : Inform of conflicts / alternative slots

note right
  Error handling (simplified): If P2 finds no availability -> return alternative slots -> Client may resubmit.
end note

@enduml
